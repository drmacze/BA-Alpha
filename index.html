<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bloodline: Ashaterra</title>
  <style>
    :root {
      --color-primary: #2b0e0e;
      --color-accent: #c42b2b;
      --color-text: #fff;
      --font-main: 'Segoe UI', sans-serif;
    }
    body {
      margin: 0;
      font-family: var(--font-main);
      background: linear-gradient(to bottom, #1e0e0e, #000);
      color: var(--color-text);
      overflow-x: hidden;
    }
    .container {
      max-width: 480px;
      margin: auto;
      padding: 30px 20px;
      text-align: center;
    }
    .step {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    .step.active {
      display: block;
    }
    h1, h2 {
      color: #ffebcd;
    }
    input, select {
      width: 90%;
      padding: 10px;
      margin: 10px auto;
      display: block;
      border: none;
      border-radius: 6px;
    }
    .btn {
      padding: 12px 24px;
      margin: 10px;
      background: linear-gradient(135deg, #a31111, #f33);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn:hover {
      background: #ff4444;
      transform: scale(1.05);
    }
    .rgb-line {
      height: 4px;
      background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet, red);
      background-size: 400% 400%;
      animation: rgbLoop 4s linear infinite;
      margin-top: 30px;
    }
    @keyframes rgbLoop {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
    .notif {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(40,40,40,0.9);
      padding: 12px 20px;
      border-left: 4px solid crimson;
      border-radius: 8px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .notif.show {
      opacity: 1;
    }
    footer {
      color: #888;
      text-align: right;
      font-size: 12px;
      padding: 10px;
    }
    .hidden { display: none; }
    .tap-screen {
      position: absolute;
      top: 40%;
      width: 100%;
      text-align: center;
      font-size: 24px;
      opacity: 0.8;
      animation: pulse 1.5s infinite alternate;
    }
    @keyframes pulse {
      from { transform: scale(1); opacity: 0.8; }
      to { transform: scale(1.1); opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="splash">
    <div class="tap-screen">Tap to Start</div>
    <div class="rgb-line"></div>
  </div>

  <div class="container hidden" id="mainContent">
    <!-- Steps akan muncul di sini -->

    <!-- Step: Login/Register -->
    <div class="step active" id="step-login">
      <h1>Bloodline: Ashaterra</h1>
      <h2 id="formTitle">Login</h2>

      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <input type="text" id="pin" maxlength="4" placeholder="PIN (4-digit)" />
      <input type="text" id="captcha" placeholder="Enter CAPTCHA: 74FDK" />
      <select id="country">
        <option value="">Select Country</option>
        <option>Indonesia</option>
        <option>USA</option>
        <option>Japan</option>
        <option>Germany</option>
        <option>Other</option>
      </select>
      <input type="date" id="dob" />

      <button class="btn" onclick="handleAuth()">Login</button>
      <button class="btn" onclick="toggleAuth()">Switch to Register</button>
      <p onclick="forgotPass()" style="color:#aaa; cursor:pointer;">Forgot Password?</p>

      <div id="notif" class="notif"></div>
      <footer>
        v3.0 - ID: <span id="userId">-</span>
      </footer>
    </div>

    <!-- Step: Avatar Selection -->
    <div class="step" id="step-avatar">
      <h2>Select Your Avatar</h2>
      <div id="avatarGrid"></div>
      <button class="btn" onclick="goToStep('step-role')">Next</button>
    </div>

    <!-- Step: Role Selection -->
    <div class="step" id="step-role">
      <h2>Choose Your Role</h2>
      <select id="role">
        <option>Pyromancer (Fire)</option>
        <option>Shadowblade (Dark)</option>
        <option>Druid (Nature)</option>
        <option>Chronoguard (Time)</option>
        <option>Celestian (Light)</option>
        <option>Ashfallen (Void)</option>
      </select>
      <button class="btn" onclick="goToStep('step-gender')">Next</button>
    </div>

    <!-- Step: Gender Selection -->
    <div class="step" id="step-gender">
      <h2>Select Gender</h2>
      <select id="gender">
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>
      <button class="btn" onclick="goToStep('step-body')">Next</button>
    </div>

    <!-- Step: Body & Details -->
    <div class="step" id="step-body">
      <h2>Customize Appearance</h2>
      <input type="text" id="eyes" placeholder="Eye Type (e.g. Sharp)" />
      <input type="text" id="hair" placeholder="Hair Style" />
      <input type="color" id="eyeColor" value="#552200" />
      <input type="color" id="hairColor" value="#222222" />
      <input type="number" id="height" placeholder="Height (cm)" />
      <input type="text" id="tattoo" placeholder="Tattoo Type" />
      <input type="text" id="tattooPlace" placeholder="Tattoo Placement" />
      <button class="btn" onclick="goToStep('step-gear')">Next</button>
    </div>

    <!-- Step: Gear & Outfit -->
    <div class="step" id="step-gear">
      <h2>Choose Gear & Outfit</h2>
      <input type="text" id="top" placeholder="Top (e.g. Hoodie)" />
      <input type="text" id="bottom" placeholder="Bottom (e.g. Jeans)" />
      <input type="text" id="footwear" placeholder="Footwear" />
      <input type="text" id="accessory" placeholder="Accessory (e.g. Glasses)" />
      <button class="btn" onclick="goToStep('step-pact')">Continue</button>
    </div>

    <!-- Step: Blood Pact System -->
    <div class="step" id="step-pact">
      <h2>Blood Pact</h2>
      <p>Do you wish to forge a Blood Pact for forbidden power?</p>
      <select id="pact">
        <option value="none">No Pact</option>
        <option value="curse-of-flame">Curse of Flame</option>
        <option value="void-oath">Oath of the Void</option>
        <option value="immortal-chain">Immortal Chain</option>
      </select>
      <button class="btn" onclick="finalizeCharacter()">Finalize Character</button>
    </div>

    <!-- Step: Welcome / Result -->
    <div class="step" id="step-result">
      <h2>Welcome, <span id="resultName"></span>!</h2>
      <p>You have received:</p>
      <ul>
        <li>Starter Pack: 1000 Gold</li>
        <li>Gear: Traveler's Cloak</li>
        <li>Pact Status: <span id="pactStatus"></span></li>
      </ul>
      <div class="btn" onclick="alert('Main menu soon...')">Proceed to Main Menu</div>
    </div>
  </div>

  <div id="notif" class="notif"></div>
<script>
  const steps = document.querySelectorAll('.step');
  const splash = document.getElementById("splash");
  const mainContent = document.getElementById("mainContent");
  const notif = document.getElementById("notif");

  let isLogin = true;

  document.body.addEventListener("click", () => {
    if (!mainContent.classList.contains("hidden")) return;
    splash.classList.add("hidden");
    mainContent.classList.remove("hidden");
  }, { once: true });

  function goToStep(id) {
    steps.forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }

  function toggleAuth() {
    isLogin = !isLogin;
    document.getElementById("formTitle").innerText = isLogin ? "Login" : "Register";
    document.querySelector(".btn").innerText = isLogin ? "Login" : "Register";
  }

  function notify(msg, success = false) {
    notif.innerText = msg;
    notif.style.borderLeft = success ? '4px solid lime' : '4px solid crimson';
    notif.classList.add("show");
    setTimeout(() => notif.classList.remove("show"), 4000);
    navigator.vibrate?.(success ? 50 : [100, 50, 100]);
  }

  function handleAuth() {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;
    const pin = document.getElementById("pin").value;
    const dob = new Date(document.getElementById("dob").value);
    const captcha = document.getElementById("captcha").value;
    const country = document.getElementById("country").value;

    const age = new Date().getFullYear() - dob.getFullYear();
    const id = email + "::" + pass;

    if (!email || !pass || !pin || !captcha || !dob || !country)
      return notify("Please fill all fields.");
    if (pin.length !== 4) return notify("PIN must be 4 digits.");
    if (captcha.toUpperCase() !== "74FDK") return notify("CAPTCHA incorrect.");
    if (age < 13) return notify("You must be 13+ to register.");

    if (isLogin) {
      const user = localStorage.getItem(id);
      if (!user) return notify("Account not found.");
      notify("Login successful!", true);
      setTimeout(() => {
        document.getElementById("userId").innerText = id.split("::")[0];
        goToStep("step-avatar");
        createAvatars();
      }, 1000);
    } else {
      if (localStorage.getItem(id)) return notify("Account already exists.");
      const userData = JSON.stringify({ email, pass, pin, dob, country });
      localStorage.setItem(id, userData);
      notify("Account registered!", true);
    }
  }

  function forgotPass() {
    const email = document.getElementById("email").value;
    if (!email) return notify("Enter your email.");
    notify("Reset link (simulated) sent to: " + email, true);
  }

  function createAvatars() {
    const grid = document.getElementById("avatarGrid");
    grid.innerHTML = "";
    for (let i = 1; i <= 12; i++) {
      const img = document.createElement("img");
      img.src = `https://api.dicebear.com/7.x/adventurer/svg?seed=${i}`;
      img.style.width = "70px";
      img.style.margin = "5px";
      img.style.border = "2px solid transparent";
      img.style.borderRadius = "50%";
      img.onclick = () => {
        document.querySelectorAll("#avatarGrid img").forEach(x => x.style.border = "2px solid transparent");
        img.style.border = "2px solid lime";
        localStorage.setItem("avatar", img.src);
      };
      grid.appendChild(img);
    }
  }

  function finalizeCharacter() {
    const pact = document.getElementById("pact").value;
    const role = document.getElementById("role").value;
    const gender = document.getElementById("gender").value;
    const details = {
      eyes: document.getElementById("eyes").value,
      hair: document.getElementById("hair").value,
      eyeColor: document.getElementById("eyeColor").value,
      hairColor: document.getElementById("hairColor").value,
      height: document.getElementById("height").value,
      tattoo: document.getElementById("tattoo").value,
      tattooPlace: document.getElementById("tattooPlace").value,
      top: document.getElementById("top").value,
      bottom: document.getElementById("bottom").value,
      footwear: document.getElementById("footwear").value,
      accessory: document.getElementById("accessory").value,
      gender, role, pact,
      avatar: localStorage.getItem("avatar")
    };
    localStorage.setItem("character", JSON.stringify(details));
    notify("Character created!", true);
    document.getElementById("resultName").innerText = role;
    document.getElementById("pactStatus").innerText = pact.replaceAll("-", " ");
    goToStep("step-result");
  }
</script>
</body>
</html>