<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Bloodline: Ashaterra</title>

<style>
  /* Reset & base */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: 'Roboto Slab', serif;
  }

  body, html {
    height: 100%;
    background-color: #0b0c10;
    color: #c5c6c7;
    overflow: hidden;
  }

  .screen {
    display: none;
    height: 100vh;
    width: 100vw;
    position: relative;
    text-align: center;
    background: #1f2833;
    color: #c5c6c7;
    padding: 20px;
  }

  .screen.active {
    display: block;
  }

  .bg-image {
    position: absolute;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    filter: brightness(0.4) blur(1.2px);
    z-index: -1;
  }

  .logo {
    font-size: 3rem;
    font-weight: 700;
    margin-top: 35vh;
    color: #66fcf1;
    text-shadow: 0 0 10px #45a29e;
    animation: glow 2.5s ease-in-out infinite alternate;
  }

  @keyframes glow {
    from {
      text-shadow: 0 0 10px #45a29e, 0 0 20px #45a29e, 0 0 30px #66fcf1;
    }
    to {
      text-shadow: 0 0 20px #66fcf1, 0 0 30px #45a29e, 0 0 40px #66fcf1;
    }
  }

  .loading-bar {
    width: 60vw;
    height: 8px;
    background-color: #45a29e44;
    margin: 30px auto;
    border-radius: 4px;
    overflow: hidden;
  }

  .progress {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #45a29e, #66fcf1);
    animation: loading 3s forwards;
  }

  @keyframes loading {
    to {
      width: 100%;
    }
  }

  h1 {
    margin-bottom: 25px;
    font-weight: 600;
    color: #66fcf1;
    text-shadow: 0 0 7px #45a29e;
  }

  .btn {
    display: inline-block;
    padding: 15px 40px;
    margin: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 35px;
    cursor: pointer;
    transition: all 0.3s ease;
    user-select: none;
    box-shadow: 0 0 10px #45a29e55;
    border: none;
  }

  .btn.primary {
    background-color: #45a29e;
    color: #0b0c10;
  }

  .btn.primary:hover {
    background-color: #66fcf1;
    box-shadow: 0 0 20px #66fcf1aa;
  }

  .btn.secondary {
    background-color: transparent;
    color: #66fcf1;
    border: 2px solid #66fcf1;
  }

  .btn.secondary:hover {
    background-color: #66fcf1;
    color: #0b0c10;
  }

  .message {
    margin-top: 15px;
    color: #ff6f61;
    font-weight: 700;
    min-height: 24px;
    transition: opacity 0.3s ease;
    opacity: 0;
  }

  .message.show {
    opacity: 1;
  }
</style>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet" />

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

</head>
<body>

<!-- Splash Screen -->
<div id="splash-screen" class="screen active">
  <img src="assets/bg-ashaterra.jpg" alt="Ashaterra Background" class="bg-image" />
  <div class="logo">Bloodline: Ashaterra</div>
  <div class="loading-bar"><div class="progress"></div></div>
</div>

<!-- Login Screen -->
<div id="login-screen" class="screen">
  <h1>Login to Bloodline: Ashaterra</h1>
  <button id="google-login-btn" class="btn primary">Login with Google</button>
  <button id="guest-login-btn" class="btn secondary">Play as Guest</button>
  <div id="login-message" class="message"></div>
</div>

<script>
  // Core system
  const Core = (() => {
    const splashScreen = document.getElementById("splash-screen");
    const loginScreen = document.getElementById("login-screen");
    const loginMessage = document.getElementById("login-message");

    const showSplashThenLogin = () => {
      splashScreen.classList.add("active");
      loginScreen.classList.remove("active");
      setTimeout(() => {
        splashScreen.classList.remove("active");
        loginScreen.classList.add("active");
      }, 3200);
    };

    const showMessage = (msg, duration = 3000) => {
      loginMessage.textContent = msg;
      loginMessage.classList.add("show");
      setTimeout(() => loginMessage.classList.remove("show"), duration);
    };

    const init = () => {
      showSplashThenLogin();
    };

    return {
      init,
      showMessage,
    };
  })();

  // Firebase config and auth
  const firebaseConfig = {
    apiKey: "AIzaSyAstsRmnykZJlueSMdJMPYEs1l-udFWWT0",
    authDomain: "bloodline-ashaterra.firebaseapp.com",
    projectId: "bloodline-ashaterra",
    storageBucket: "bloodline-ashaterra.firebasestorage.app",
    messagingSenderId: "925417667104",
    appId: "1:925417667104:web:e2ccafa1629333ef789a45",
    measurementId: "G-E8JV3WYFXV"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // Elements
  const googleLoginBtn = document.getElementById("google-login-btn");
  const guestLoginBtn = document.getElementById("guest-login-btn");
  const loginMessage = document.getElementById("login-message");

  googleLoginBtn.addEventListener("click", () => {
    Core.showMessage("Logging in with Google...");
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider)
      .then(result => {
        Core.showMessage(`Welcome, ${result.user.displayName}`, 4000);
        // TODO: lanjut ke game utama
        setTimeout(() => {
          alert("Game akan segera dikembangkan lanjut setelah login.");
        }, 1000);
      })
      .catch(error => {
        Core.showMessage("Google login failed: " + error.message);
      });
  });

  guestLoginBtn.addEventListener("click", () => {
    Core.showMessage("Logging in as Guest...");
    auth.signInAnonymously()
      .then(() => {
        Core.showMessage("Guest login successful", 3000);
        // TODO: lanjut ke game utama
        setTimeout(() => {
          alert("Game akan segera dikembangkan lanjut setelah login.");
        }, 1000);
      })
      .catch(error => {
        Core.showMessage("Guest login failed: " + error.message);
      });
  });

  auth.onAuthStateChanged(user => {
    if (user) {
      console.log("User logged in:", user.uid);
    } else {
      console.log("No user logged in");
    }
  });

  window.addEventListener("DOMContentLoaded", () => {
    Core.init();
  });
</script>

</body>
</html>