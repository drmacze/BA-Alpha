<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bloodline: Ashaterra</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: radial-gradient(ellipse at center, #1a0d0d, #000);
      color: #fff;
      overflow-x: hidden;
    }
    .step {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 30px;
    }
    .step.active {
      display: flex;
    }
    h1, h2 {
      margin: 0 0 20px;
      text-align: center;
    }
    input, select {
      padding: 10px;
      margin: 8px;
      border: none;
      border-radius: 5px;
      width: 250px;
      font-size: 14px;
    }
    .btn {
      padding: 12px 25px;
      background: maroon;
      border: none;
      border-radius: 5px;
      margin: 15px;
      cursor: pointer;
      color: #fff;
      font-weight: bold;
      transition: 0.3s;
    }
    .btn:hover {
      background: #a00;
      transform: scale(1.05);
    }
    .notif {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #222;
      color: #fff;
      padding: 12px;
      border-left: 4px solid crimson;
      border-radius: 5px;
      display: none;
    }
    .notif.show {
      display: block;
      animation: fadein 0.5s;
    }
    footer {
      position: fixed;
      bottom: 10px;
      right: 10px;
      font-size: 12px;
      color: #888;
    }
    #avatarGrid img {
      width: 70px;
      border-radius: 50%;
      margin: 5px;
      cursor: pointer;
      transition: 0.2s;
    }
    #avatarGrid img:hover {
      transform: scale(1.1);
    }
    #avatarGrid img.selected {
      border: 2px solid lime;
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .rgb-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      height: 5px;
      width: 100%;
      background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet);
      animation: rgbMove 4s linear infinite;
    }
    @keyframes rgbMove {
      from { background-position: 0 0; }
      to { background-position: 200% 0; }
    }
  </style>
</head>
<body>
  <div id="mainContent">
    <!-- Step: Login/Register -->
    <div class="step active" id="step-login">
      <h1>Bloodline: Ashaterra</h1>
      <h2 id="formTitle">Login</h2>
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <input type="text" id="pin" maxlength="4" placeholder="PIN (4-digit)" />
      <input type="text" id="captcha" placeholder="Enter CAPTCHA: 74FDK" />
      <select id="country">
        <option value="">Select Country</option>
        <option>Indonesia</option>
        <option>USA</option>
        <option>Japan</option>
        <option>Germany</option>
        <option>Other</option>
      </select>
      <input type="date" id="dob" />
      <button class="btn" onclick="handleAuth()">Login</button>
      <button class="btn" onclick="toggleAuth()">Switch to Register</button>
      <p onclick="forgotPass()" style="color:#aaa; cursor:pointer;">Forgot Password?</p>
      <footer>
        v3.0 â€¢ ID: <span id="userId">-</span>
      </footer>
    </div>

    <!-- Step: Avatar -->
    <div class="step" id="step-avatar">
      <h2>Select Your Avatar</h2>
      <div id="avatarGrid"></div>
      <button class="btn" onclick="goToStep('step-role')">Next</button>
    </div>

    <!-- Step: Role -->
    <div class="step" id="step-role">
      <h2>Choose Role</h2>
      <select id="role">
        <option>Pyromancer</option>
        <option>Shadowblade</option>
        <option>Druid</option>
        <option>Chronoguard</option>
        <option>Celestian</option>
        <option>Ashfallen</option>
      </select>
      <button class="btn" onclick="goToStep('step-gender')">Next</button>
    </div>

    <!-- Step: Gender -->
    <div class="step" id="step-gender">
      <h2>Select Gender</h2>
      <select id="gender">
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>
      <button class="btn" onclick="goToStep('step-body')">Next</button>
    </div>

    <!-- Step: Appearance -->
    <div class="step" id="step-body">
      <h2>Customize Appearance</h2>
      <input type="text" id="eyes" placeholder="Eye Type" />
      <input type="text" id="hair" placeholder="Hair Style" />
      <input type="color" id="eyeColor" value="#552200" />
      <input type="color" id="hairColor" value="#222222" />
      <input type="number" id="height" placeholder="Height (cm)" />
      <input type="text" id="tattoo" placeholder="Tattoo Type" />
      <input type="text" id="tattooPlace" placeholder="Tattoo Placement" />
      <button class="btn" onclick="goToStep('step-gear')">Next</button>
    </div>

    <!-- Step: Gear -->
    <div class="step" id="step-gear">
      <h2>Choose Gear</h2>
      <input type="text" id="top" placeholder="Top (e.g. Hoodie)" />
      <input type="text" id="bottom" placeholder="Bottom (e.g. Jeans)" />
      <input type="text" id="footwear" placeholder="Footwear" />
      <input type="text" id="accessory" placeholder="Accessory (e.g. Glasses)" />
      <button class="btn" onclick="goToStep('step-pact')">Continue</button>
    </div>

    <!-- Step: Pact -->
    <div class="step" id="step-pact">
      <h2>Blood Pact</h2>
      <p>Choose a pact for forbidden power:</p>
      <select id="pact">
        <option value="none">No Pact</option>
        <option value="curse-of-flame">Curse of Flame</option>
        <option value="void-oath">Oath of the Void</option>
        <option value="immortal-chain">Immortal Chain</option>
      </select>
      <button class="btn" onclick="finalizeCharacter()">Finalize Character</button>
    </div>

    <!-- Final Step -->
    <div class="step" id="step-result">
      <h2>Welcome, <span id="resultName"></span>!</h2>
      <p>You received:</p>
      <ul>
        <li>Starter Pack: 1000 Gold</li>
        <li>Traveler's Cloak</li>
        <li>Pact: <span id="pactStatus"></span></li>
      </ul>
      <button class="btn" onclick="alert('Next: Entering Ashaterra...')">Enter World</button>
    </div>
  </div>

  <div id="notif" class="notif"></div>
  <div class="rgb-bar"></div>

  <script>
    const steps = document.querySelectorAll('.step');
    const notif = document.getElementById("notif");
    let isLogin = true;

    function goToStep(id) {
      steps.forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    function toggleAuth() {
      isLogin = !isLogin;
      document.getElementById("formTitle").innerText = isLogin ? "Login" : "Register";
      document.querySelector("button").innerText = isLogin ? "Login" : "Register";
    }

    function notify(msg, success = false) {
      notif.innerText = msg;
      notif.style.borderLeft = success ? '4px solid lime' : '4px solid crimson';
      notif.classList.add("show");
      setTimeout(() => notif.classList.remove("show"), 4000);
      navigator.vibrate?.(success ? 50 : [100, 50, 100]);
    }

    function handleAuth() {
      const email = email.value.trim();
      const pass = password.value.trim();
      const pin = pin.value.trim();
      const dob = new Date(dobInput.value);
      const captchaVal = captcha.value.trim().toUpperCase();
      const country = country.value;
      const age = new Date().getFullYear() - dob.getFullYear();
      const id = email + "::" + pass;

      if (!email || !pass || !pin || !captchaVal || !dob || !country)
        return notify("Please fill all fields.");
      if (pin.length !== 4) return notify("PIN must be 4 digits.");
      if (captchaVal !== "74FDK") return notify("CAPTCHA incorrect.");
      if (age < 13) return notify("You must be 13+ to register.");

      if (isLogin) {
        const user = localStorage.getItem(id);
        if (!user) return notify("Account not found.");
        localStorage.setItem("activeUser", id);
        document.getElementById("userId").innerText = email;
        notify("Login successful!", true);
        setTimeout(() => { goToStep("step-avatar"); createAvatars(); }, 800);
      } else {
        if (localStorage.getItem(id)) return notify("Account already exists.");
        localStorage.setItem(id, JSON.stringify({ email, pass, pin, dob, country }));
        localStorage.setItem("activeUser", id);
        document.getElementById("userId").innerText = email;
        notify("Account created!", true);
        setTimeout(() => { goToStep("step-avatar"); createAvatars(); }, 800);
      }
    }

    function forgotPass() {
      const email = document.getElementById("email").value;
      if (!email) return notify("Enter your email.");
      notify("Reset link (simulated) sent to " + email, true);
    }

    function createAvatars() {
      const grid = document.getElementById("avatarGrid");
      grid.innerHTML = "";
      for (let i = 1; i <= 8; i++) {
        const img = document.createElement("img");
        img.src = `https://api.dicebear.com/7.x/adventurer/svg?seed=${i}`;
        img.onclick = () => {
          document.querySelectorAll("#avatarGrid img").forEach(x => x.classList.remove("selected"));
          img.classList.add("selected");
          localStorage.setItem("avatar", img.src);
        };
        grid.appendChild(img);
      }
    }

    function finalizeCharacter() {
      const pact = document.getElementById("pact").value;
      const role = document.getElementById("role").value;
      const gender = document.getElementById("gender").value;
      const details = {
        eyes: eyes.value,
        hair: hair.value,
        eyeColor: eyeColor.value,
        hairColor: hairColor.value,
        height: height.value,
        tattoo: tattoo.value,
        tattooPlace: tattooPlace.value,
        top: top.value,
        bottom: bottom.value,
        footwear: footwear.value,
        accessory: accessory.value,
        gender, role, pact,
        avatar: localStorage.getItem("avatar")
      };
      localStorage.setItem("character", JSON.stringify(details));
      notify("Character created!", true);
      document.getElementById("resultName").innerText = role;
      document.getElementById("pactStatus").innerText = pact.replaceAll("-", " ");
      goToStep("step-result");
    }
  </script>
</body>
</html>